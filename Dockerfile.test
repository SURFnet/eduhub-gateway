FROM node:18

# copy to least likely to change files first to allow caching
COPY vendor /app/vendor

COPY node_modules /app/node_modules
COPY *.json /app/
WORKDIR /app
RUN npm install --production

COPY *.js /app/
COPY config /app/config
COPY lib /app/lib
COPY policies /app/policies

CMD npm start

EXPOSE 8080
