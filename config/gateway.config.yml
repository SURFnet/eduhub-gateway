http:
  port: 8080
admin:
  port: 9876
  host: localhost
apiEndpoints:
  api:
    host: localhost
    paths: ['/', '/courses','/courses/*', '/organizations','/organizations/*','/buildings','/buildings/*']
  example:
    host: localhost
    paths: ['/example', '/example/:id']
serviceEndpoints:
  mockOwl:
    url: '${OOAPI_MOCK_URL:-http://localhost:8081}'
  invalid-backend:
    url: '${OOAPI_INVALID_BACKEND_URL:-http://localhost:8082}'
policies:
  - basic-auth
  - cors
  - expression
  - key-auth
  - log
  - oauth2
  - proxy
  - rate-limit
  - example
  - openapi-validator
  - gatekeeper
  - response-transformer
pipelines:
  example:
    apiEndpoints:
      - example
    policies:
      - gatekeeper:
          - action:
              acls:
                - app: fred
                  endpoints:
                    - endpoint: wilma
                      paths: ['/example', '/example/:id']
                    - endpoint: betty
                      paths: ['/example']
                - app: barney
                  endpoints:
                    - endpoint: betty
                      paths: ['/example', '/example/:id']
      - example:
  default:
    apiEndpoints:
      - api
    policies:
      - response-transformer:
          - action:
              headers:
                add:
                  # note: literal header values should be quoted twice
                  # see https://www.express-gateway.io/docs/policies/response-transformer/
                  'X-XSS-Protection': "'1; mode-block'"
                  'Strict-Transport-Security': "'max-age=31536000; includeSubDomains; preload'"
                  'X-Frame-Options': "'SAMEORIGIN'"
                  'X-Content-Type-Options': "'nosniff'"
                  # note: double escaping because of YAML parsing
                  'Content-Security-Policy': "'default-src \\'self\\''"
                  'Access-Control-Allow-Origin': "'*.surf.nl'"
                  'Referrer-Policy': "'no-referrer-when-downgrade'"
      - openapi-validator:
          - action:
              apiSpec: "ooapiv4.json"
              validateResponses: true
              validateRequests: true
      - proxy:
          - action:
              serviceEndpoint: invalid-backend
              changeOrigin: true
